<!doctype html>
<html>
	<head>
		<meta charset="utf-8">

		<title>Process API</title>

		<meta name="author" content="redtide">
		<meta name="web-author" content="redtide">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- Atom Feeds -->
		<link href="/atom.xml" rel="alternate" title="News" type="application/atom+xml" />

				<!-- Favicon Generator Icons -->
		<link rel="apple-touch-icon" sizes="180x180" href="/assets/ico/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/assets/ico/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/assets/ico/favicon-16x16.png">
		<link rel="manifest" href="/assets/ico/site.webmanifest">
		<link rel="mask-icon" href="/assets/ico/safari-pinned-tab.svg" color="#302e31">
		<link rel="shortcut icon" href="/assets/ico/favicon.ico">
		<meta name="msapplication-TileColor" content="#302e31">
		<meta name="msapplication-config" content="/assets/ico/browserconfig.xml">
		<meta name="theme-color" content="#ffffff">

		<!-- Stylesheets -->
		<link href="/assets/css/style.min.css" rel="stylesheet" media="screen">
		    <link href="/assets/css/ekko-lightbox.css" rel="stylesheet">

		<!-- Font Awesome Icons -->
		<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/solid.js"       integrity="sha384-Mf3ap7OwO+bjTkzM1RsrothLh38uKXvMWJ2TQPXGHqZcqfeI/cyCV+sfV0IDnBDq" crossorigin="anonymous"></script>
		<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/brands.js"      integrity="sha384-b2GpqFrJizV0BUEdbrITdOA5HnxnlrErt7MlEERWd6NSJ32rHeibEvyyCuA13OAS" crossorigin="anonymous"></script>
		<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/fontawesome.js" integrity="sha384-EYYaHDhIRoBhd/Ir/1fPnxg9rZLk/55lKtlNT5KrIcONoCS2kjf7ZWzMoCLLACeo" crossorigin="anonymous"></script>

	</head>

	<body>

		<button
			data-localize="site_scroll_top"
			onclick="topFunction()"
			id="scrollButton"
			title="Go to top"
		>
			Top
		</button>
		<a href="#content" class="sr-only">Skip to content</a>
		<div class="container">
<nav class="navbar navbar-expand-lg navbar-dark header-dark">
				<a
					id="logo-link"
					class="navbar-brand"
					href="/en/"
				>
					<img
						class="d-inline-block align-top"
						src="/assets/img/logo.svg"
						height="32" alt=""
					> Lite XL</a>
				<button
					class="navbar-toggler"
					type="button"
					data-target="#navbarContent"
					data-toggle="collapse"
					aria-controls="navbarContent"
					aria-expanded="false"
					aria-label="Toggle navigation"
				>
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarContent">
					<ul class="navbar-nav mr-auto mt-2 mt-lg-0">


	
		
		
						<li class="nav-item dropdown">
							<a
								id="navbar_about"
								class="nav-link dropdown-toggle font-weight-bold"
								data-localize="menu_about"
								data-toggle="dropdown"
								aria-expanded="false"
								aria-haspopup="true"
								href="#"
							>
								About
							</a>
							<div
								class="dropdown-menu"
								aria-labelledby="navbar_about"
							>
		
			
				
				<a
					class="dropdown-item font-weight-bold"
					href="/en/about/faq"
				><i
						class="fas fa-question fa-fw"
						aria-hidden="true"
					></i>&nbsp;<span data-localize="menu_faq">FAQ</span>
				</a>
			
		
			
				
				<a
					class="dropdown-item font-weight-bold"
					href="/en/about/features/"
				><i
						class="fas fa-info fa-fw"
						aria-hidden="true"
					></i>&nbsp;<span data-localize="menu_features">Features</span>
				</a>
			
		
			
				
				<a
					class="dropdown-item font-weight-bold"
					href="/en/about/screenshots/"
				><i
						class="fas fa-image fa-fw"
						aria-hidden="true"
					></i>&nbsp;<span data-localize="menu_screenshots">Screenshots</span>
				</a>
			
		
			
				
				<a
					class="dropdown-item font-weight-bold"
					href="/en/about/contributors"
				><i
						class="fas fa-users fa-fw"
						aria-hidden="true"
					></i>&nbsp;<span data-localize="menu_contributors">Contributors</span>
				</a>
			
		
							</div>
	
						</li>

	
		
		
						<li class="nav-item dropdown">
							<a
								id="navbar_documentation"
								class="nav-link dropdown-toggle font-weight-bold"
								data-localize="menu_documentation"
								data-toggle="dropdown"
								aria-expanded="false"
								aria-haspopup="true"
								href="#"
							>
								Documentation
							</a>
							<div
								class="dropdown-menu"
								aria-labelledby="navbar_documentation"
							>
		
			
				
				<a
					class="dropdown-item font-weight-bold"
					href="/en/documentation/usage"
				><i
						class="fas fa-book fa-fw"
						aria-hidden="true"
					></i>&nbsp;<span data-localize="menu_usage">Usage</span>
				</a>
			
		
			
				
				<a
					class="dropdown-item font-weight-bold"
					href="/en/documentation/build/"
				><i
						class="fas fa-code fa-fw"
						aria-hidden="true"
					></i>&nbsp;<span data-localize="menu_build">Build</span>
				</a>
			
		
			
				
				<a
					class="dropdown-item font-weight-bold"
					href="/en/documentation/keymap"
				><i
						class="fas fa-keyboard fa-fw"
						aria-hidden="true"
					></i>&nbsp;<span data-localize="menu_keymap">Keymap</span>
				</a>
			
		
							</div>
	
						</li>

	
		
		
						<li class="nav-item dropdown">
							<a
								id="navbar_plugins"
								class="nav-link dropdown-toggle font-weight-bold"
								data-localize="menu_plugins"
								data-toggle="dropdown"
								aria-expanded="false"
								aria-haspopup="true"
								href="#"
							>
								Plugins
							</a>
							<div
								class="dropdown-menu"
								aria-labelledby="navbar_plugins"
							>
		
			
				
				<a
					class="dropdown-item font-weight-bold"
					href="/en/plugins/repository"
				><i
						class="fab fa-github fa-fw"
						aria-hidden="true"
					></i>&nbsp;<span data-localize="menu_repository">Repository</span>
				</a>
			
		
			
				
				<a
					class="dropdown-item font-weight-bold"
					href="/en/plugins/external"
				><i
						class="fas fa-link fa-fw"
						aria-hidden="true"
					></i>&nbsp;<span data-localize="menu_externals">Externals</span>
				</a>
			
		
							</div>
	
						</li>

	
		
		
						<li class="nav-item dropdown">
							<a
								id="navbar_tutorials"
								class="nav-link dropdown-toggle font-weight-bold"
								data-localize="menu_tutorials"
								data-toggle="dropdown"
								aria-expanded="false"
								aria-haspopup="true"
								href="#"
							>
								Tutorials
							</a>
							<div
								class="dropdown-menu"
								aria-labelledby="navbar_tutorials"
							>
		
			
				
				<a
					class="dropdown-item font-weight-bold"
					href="/en/tutorials/simple-plugin"
				><span data-localize="menu_simple_plugin">Simple Plugin</span>
				</a>
			
		
			
				
				<a
					class="dropdown-item font-weight-bold"
					href="/en/tutorials/api-overview"
				><span data-localize="menu_api_overview">API Overview</span>
				</a>
			
		
							</div>
	
						</li>

	
		
						<li class="nav-item">
							<a
								class="nav-link font-weight-bold"
								data-localize="menu_downloads"
								href="/en/downloads"
							><i
								class="fas fa-download fa-fw"
								aria-hidden="true"
							></i>&nbsp;Downloads
							</a>
	
						</li>

						<li class="nav-item">
							<a
								class="nav-link font-weight-bold"
								data-localize="menu_search"
								href="/search/"
							>
							<i class="fas fa-search fa-fw" aria-hidden="true"></i>
								Search</a>
						</li>
					</ul>
				</div>
			</nav>

			<div class="row mt-4" id="content">
				<div class="col-md-9">
					<article>

						<h1>Process API</h1>

<p>Lite XL provides a process API to launch external applications. This API is meant to replace
lua’s <code class="language-plaintext highlighter-rouge">io.popen</code> and lite’s <a href="https://github.com/rxi/console/blob/fb3d414d085d4110364314d6cd8380dc1d386249/init.lua#L100">pipe-to-a-file</a> approach.</p>

<p>Advantages of this API includes:</p>
<ul>
  <li>Proper argument escaping (arguments are supplied via a table)</li>
  <li>Nonblocking IO</li>
  <li>Able to detach processes from Lite XL <a href="https://github.com/lite-xl/lite-xl/pull/535">(in progress)</a></li>
  <li>Does not create temporary files</li>
  <li>Mostly cross-platform (does not require special code for each shell)</li>
</ul>

<h3 id="using-the-process-api">Using the Process API</h3>

<h4 id="error-handling">Error handling</h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">process.start()</code> may throw errors if it cannot run the program.</li>
  <li><code class="language-plaintext highlighter-rouge">process.read*</code> and <code class="language-plaintext highlighter-rouge">process.write</code> functions may throw errors if
    <ul>
      <li>the process ended</li>
      <li>the process closed the stream</li>
      <li>you closed the stream</li>
    </ul>
  </li>
  <li>there might be other errors to look forward to too</li>
</ul>

<h4 id="starting-a-process">Starting a process</h4>
<p>To start a process, use <code class="language-plaintext highlighter-rouge">process.start(args, options)</code>.</p>

<p>Here are some of the more useful arguments.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">args</code>: The executable and any arguments, eg: <code class="language-plaintext highlighter-rouge">{ "sh", "-c", "echo hello world" }</code></li>
  <li><code class="language-plaintext highlighter-rouge">options</code>: Options for <code class="language-plaintext highlighter-rouge">process.start()</code>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">env</code>: A key-value table containing the env. <strong>Note that if this is provided,
        environment variables will not be inherited.</strong></li>
      <li><code class="language-plaintext highlighter-rouge">stdin</code>: Specify where to redirect stdin</li>
      <li><code class="language-plaintext highlighter-rouge">stdout</code>: Specify where to redirect stdout</li>
      <li><code class="language-plaintext highlighter-rouge">stderr</code>: Specify where to redirect stderr</li>
    </ul>
  </li>
</ul>

<p>for <code class="language-plaintext highlighter-rouge">options.std{in,out,err}</code>, valid values are:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">process.REDIRECT_PIPE</code> (Make it available to subprocess API for reading / writing)</li>
  <li><code class="language-plaintext highlighter-rouge">process.REDIRECT_DISCARD</code> (Discard the output. Use this to prevent buffering)</li>
  <li><code class="language-plaintext highlighter-rouge">process.REDIRECT_STDOUT</code> (<code class="language-plaintext highlighter-rouge">stderr</code> only, for redirecting <code class="language-plaintext highlighter-rouge">stderr</code> to <code class="language-plaintext highlighter-rouge">stdout</code>)</li>
</ul>

<h4 id="reading-from-process">Reading from process</h4>
<p>To read from <code class="language-plaintext highlighter-rouge">stdout</code> or <code class="language-plaintext highlighter-rouge">stderr</code> of a process, use <code class="language-plaintext highlighter-rouge">process:read_stdout()</code> and
<code class="language-plaintext highlighter-rouge">process:read_stderr()</code> respectively.</p>

<p>You can specify a numeric argument to them, which will change the size of internal buffer used 
to read the output.</p>

<p>Alternatively, you could use <code class="language-plaintext highlighter-rouge">process:read()</code> with <code class="language-plaintext highlighter-rouge">process.STREAM_STDERR</code> and <code class="language-plaintext highlighter-rouge">process.STREAM_STDOUT</code>.</p>

<p><strong>Example:</strong></p>
<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">proc</span> <span class="o">=</span> <span class="n">process</span><span class="p">.</span><span class="n">start</span> <span class="p">{</span> <span class="s2">"sh"</span><span class="p">,</span> <span class="s2">"-c"</span><span class="p">,</span> <span class="s2">"echo hello world!"</span> <span class="p">}</span>

<span class="c1">-- do not use `while proc:running()` if you care about output.</span>
<span class="c1">-- The process could die and leave data in the buffer</span>
<span class="c1">-- You should just read until `proc:read_stdout()` returns nil</span>
<span class="k">while</span> <span class="kc">true</span> <span class="k">do</span>
  <span class="kd">local</span> <span class="n">rdbuf</span> <span class="o">=</span> <span class="n">proc</span><span class="p">:</span><span class="n">read_stdout</span><span class="p">()</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">rdbuf</span> <span class="k">then</span> <span class="k">break</span> <span class="k">end</span>
  <span class="c1">-- yay, output</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="writing-to-process">Writing to process</h4>
<p>You can use <code class="language-plaintext highlighter-rouge">process:write(data)</code> to write a string to <code class="language-plaintext highlighter-rouge">stdin</code>.</p>

<h4 id="checking-completion">Checking completion</h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">process:running()</code> returns a boolean to indicate whether if the process is running.</li>
  <li><code class="language-plaintext highlighter-rouge">process:wait(time)</code> also does the same thing, but you specify how long it should wait (or 0 to return immediately).</li>
</ul>

<h4 id="terminating-process">Terminating process</h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">process:terminate()</code> sends SIGTERM (or Windows equivalent) to the process.</li>
  <li><code class="language-plaintext highlighter-rouge">process:kill()</code> sends SIGKILL (or Windows equivalent) to the progress.
** Use this only if <code class="language-plaintext highlighter-rouge">process:terminate()</code> cannot kill the process, <a href="http://turnoff.us/geek/dont-sigkill/">as it can cause issues</a>.</li>
</ul>

<h4 id="misc">Misc</h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">process:pid()</code> returns the PID of the process.
<strong>There are no guarantees for this PID to be correct if the process terminated early.</strong></li>
  <li><code class="language-plaintext highlighter-rouge">process:returncode()</code> returns the exit code of the process, if any</li>
  <li><code class="language-plaintext highlighter-rouge">process:close_stream()</code> closes <code class="language-plaintext highlighter-rouge">stdin</code>, <code class="language-plaintext highlighter-rouge">stdout</code> or <code class="language-plaintext highlighter-rouge">stderr</code> stream of the process.</li>
</ul>


					</article>
				</div>
					<div class="col-md-3">
						<aside>


						<div class="card border-dark mb-3">
							<div class="card-header text-light bg-dark header-dark">
								<i class=" fa-"
									aria-hidden="true"></i>
								Follow Us
							</div>
							<div class="card-body" style="padding: 0.5rem">
								<ul class="nav nav-pills flex-column">
	<li class="nav-item">
										<a class="nav-link" href="https://github.com/lite-xl/"
											title="GitHub" style="padding: 0.35rem 0.25rem">
										<i class="fab fa-github fa-fw"
										aria-hidden="true"></i>
										GitHub</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="https://discord.gg/RWzqC3nx7K"
											title="Discord" style="padding: 0.35rem 0.25rem">
										<i class="fab fa-discord fa-fw"
										aria-hidden="true"></i>
										Discord</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="https://kiwiirc.com/nextclient/#irc://irc.libera.chat:+6697/#lite-xl"
											title="IRC" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-hashtag fa-fw"
										aria-hidden="true"></i>
										IRC</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="/atom.xml"
											title="Feed" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-rss fa-fw"
										aria-hidden="true"></i>
										Feed</a>
									</li>
	
								</ul>
							</div>
						</div>

						<div class="card border-dark mb-3">
							<div class="card-header text-light bg-dark header-dark">
								<i class=" fa-"
									aria-hidden="true"></i>
								Getting Started
							</div>
							<div class="card-body" style="padding: 0.5rem">
								<ul class="nav nav-pills flex-column">
	<li class="nav-item">
										<a class="nav-link" href="https://github.com/lite-xl/lite-xl/wiki/"
											title="Wiki" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-book fa-fw"
										aria-hidden="true"></i>
										Wiki</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="https://github.com/lite-xl/lite-xl/issues/"
											title="Issue Tracker" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-bug fa-fw"
										aria-hidden="true"></i>
										Issue Tracker</a>
									</li>
	
								</ul>
							</div>
						</div>



						</aside>
					</div>
			</div>
			<hr>
			<footer>
				<p style="text-align:left;">
					<span data-localize="footer_copyright">Copyright</span>
						&copy; 2021
					<a data-localize="footer_team" href="/en/about/team">
						Lite XL Team</a>
				</p>
			</footer>

		</div>
		<script src="/assets/js/scripts.min.js"></script><!--
		<script type="text/javascript" src="/assets/js/jquery.localize.js"></script>
		<script type="text/javascript" src="/assets/js/language.js"></script>
-->
		<script type="text/javascript" src="/assets/js/anchor.min.js"></script>
    <script>
      anchors.options.placement = 'left';
      anchors.add();
    </script>
    <script defer type="text/javascript" src="/assets/js/ekko-lightbox.min.js"></script>
    <script>
    $(document).on('click', '[data-toggle="lightbox"]', function(event) {
      event.preventDefault();
      $(this).ekkoLightbox({});
    });
    </script>


	</body>
</html>
